# Swiss Creditreform Business News Digest - {{ data.date }}

{% if data.updated -%}
**Last Updated:** {{ data.last_updated | datetime_format }}  
{% endif -%}
**Generated:** {{ data.generated_at | datetime_format }}

> **Type:** {{ data.generation_type|default("incremental") }} ·
> **Topics:** {{ data.get('stats', {}).get('topics', '–') }} ·
> **Articles:** {{ data.get('stats', {}).get('total_articles', '–') }} ·
> **New (run):** {{ data.get('stats', {}).get('new_articles', 'n/a') }} ·
> **API calls:** {{ data.get('stats', {}).get('api_calls_made', 'n/a') }} ·
> **Cross-run filtered:** {{ data.get('cross_run_dedup_stats', {}).get('duplicates_found', data.get('cross_run_dedup_stats', {}).get('duplicates_filtered', 0)) }}

{% if data.source_yield %}
**Top sources today**
{% for row in data.source_yield %}- {{ row.host }} — {{ row.count }} ({{ row.share_pct }}%)
{% endfor %}
{% endif %}

---

## Topic Analysis

{% for topic_name, digest in data.topic_digests.items() %}
### {{ topic_name | topic_name }}

{% if digest.article_count > 0 -%}
**{{ digest.headline }}**

{{ digest.why_it_matters }}

{# Prefer rich source metadata if present, else fall back to plain sources #}
{% if digest.sources_meta %}

{% for source in digest.sources_meta[:max_sources] -%}
**[{{ source.title or source.url | domain_name }}]({{ source.url }})**
{% if source.key_points %}
{% for point in source.key_points -%}
- {{ point }}
{% endfor %}
{% else %}
{{ source.summary | default('Summary not available.') }}
{% endif %}

{% endfor %}
{% if digest.sources_meta | length > max_sources -%}
*... and {{ digest.sources_meta | length - max_sources }} more sources*
{% endif %}
{% elif digest.sources %}

**Sources referenced**
{% for u in digest.sources[:max_sources] -%}
- {{ u | domain_name }}
{% endfor %}
{% endif %}

{% else -%}
*No recent articles found for this topic.*
{% endif %}

---

{% endfor %}

## Report Metadata

- **Total Articles:** {{ data.total_articles | default('N/A') }}
- **Report Date:** {{ data.date }}
- **Generation Time:** {{ data.generated_at | datetime_format }}
{% if data.get('cross_run_dedup_stats') %}- **Cross-run Dedup:** {{ data.get('cross_run_dedup_stats', {}).get('duplicates_found', data.get('cross_run_dedup_stats', {}).get('duplicates_filtered', 0)) }} filtered{% endif %}
{% if data.updated -%}
- **Update Status:** Updated (originally created {{ data.created_at | datetime_format }})
{% endif %}

*This report was generated automatically by the NewsAnalysis_2.0 system.*
